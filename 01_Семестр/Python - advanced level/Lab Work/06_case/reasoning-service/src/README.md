# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ reasoning-service

```
.                                     # –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ .cache                            # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ ...                           # –ö—ç—à —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤
‚îú‚îÄ‚îÄ data                              # –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ test_graph.json               # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≥—Ä–∞—Ñ–∞
‚îú‚îÄ‚îÄ README.md                         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ src                               # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ cot                           # –ú–æ–¥—É–ª—å Chain of Thought
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py               # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥—É–ª—è
‚îÇ       ‚îú‚îÄ‚îÄ graph                     # –ú–æ–¥—É–ª—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–æ–º
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ generator.py          # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∞
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ graph_funcs.py        # –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–æ–º
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ retriever.py          # –ü–æ–∏—Å–∫ –ø–æ –≥—Ä–∞—Ñ—É
‚îÇ       ‚îú‚îÄ‚îÄ llm_adapter.py            # –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è LLM
‚îÇ       ‚îú‚îÄ‚îÄ optimizer.py              # –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä —Ü–µ–ø–æ—á–∫–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π
‚îÇ       ‚îî‚îÄ‚îÄ processor.py              # –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä Chain of Thought
‚îî‚îÄ‚îÄ main.py                           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

## –ö–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è

- `.cache/`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö Retriever.
- `data/`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è `test_graph.json`.
- `README.md`: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ (—Ç–µ–∫—É—â–∏–π —Ñ–∞–π–ª).
- `main.py`: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞.
- `src/`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º Python.

## –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è src/cot

–û—Å–Ω–æ–≤–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –º–æ–¥—É–ª—è `cot`.

- `__init__.py`: –§–∞–π–ª –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª—è `cot`.
- `graph/`: –ú–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–æ–º.
- `llm_adapter.py`: –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª—å—é.
- `optimizer.py`: –ú–æ–¥—É–ª—å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ü–µ–ø–æ—á–∫–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.
- `processor.py`: –ú–æ–¥—É–ª—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ü–µ–ø–æ—á–∫–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.


### –ü–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ src/cot/graph

- `generator.py`: –ú–æ–¥—É–ª—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –≥—Ä–∞—Ñ–∞.
- `graph_funcs.py`: –ú–æ–¥—É–ª—å —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≥—Ä–∞—Ñ–æ–º.
- `retriever.py`: –ú–æ–¥—É–ª—å –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤ –≥—Ä–∞—Ñ–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.


# –°—Ü–µ–Ω–∞—Ä–∏–π —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ reasoning-service

## 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞

1.1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `TGI_Adapter` –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª—å—é.
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `ChainOfThoughtProcessor` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ü–µ–ø–æ—á–∫–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `ChainOptimizer` –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ü–µ–ø–æ—á–∫–∏.
- –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∞ –∏–∑ —Ñ–∞–π–ª–∞, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω –ø—É—Ç—å.

## 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞

2.1. –í—ã–∑–æ–≤ `process_query`:
- –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞.
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –æ–Ω –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω.
- –ó–∞–ø—É—Å–∫ —Ü–∏–∫–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —à–∞–≥–æ–≤ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.

2.2. –¶–∏–∫–ª –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —à–∞–≥–æ–≤:
- –í—ã–∑–æ–≤ `processor.process_thought` –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ —à–∞–≥–∞.
- –û—Ü–µ–Ω–∫–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º—ã—Å–ª–∏.
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º—ã—Å–ª–∏.
- –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è, –µ—Å–ª–∏ –æ–Ω–æ —Å–≤—è–∑–∞–Ω–æ —Å –≥—Ä–∞—Ñ–æ–º.
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à–∞–≥–∞ –≤ —Ü–µ–ø–æ—á–∫—É —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π.

2.3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ü–µ–ø–æ—á–∫–∏:
- –í—ã–∑–æ–≤ `optimizer.optimize_chain` –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏.
- –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏.

2.4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞:
- –í—ã–∑–æ–≤ `_generate_final_answer` –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏.

2.5. –í–æ–∑–≤—Ä–∞—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
- –í–æ–∑–≤—Ä–∞—Ç —Å–ª–æ–≤–∞—Ä—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º, —à–∞–≥–∞–º–∏ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π, –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–º –æ—Ç–≤–µ—Ç–æ–º.

## –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ –∏ –ª–æ–≥–æ–≤

```
2024-07-27 16:42:12,987 - __main__ - INFO - ================================================================================
2024-07-27 16:42:12,987 - __main__ - INFO -          ü§ñ Chain of Thought Reasoning with Graph Support         
2024-07-27 16:42:12,987 - __main__ - INFO - ================================================================================

2024-07-27 16:42:12,988 - __main__ - INFO - 
================================================================================
2024-07-27 16:42:12,988 - __main__ - INFO - –ó–∞–¥–∞—á–∞: –†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è —Ñ–ª–æ—Ç–∞ –≥—Ä—É–∑–æ–≤—ã—Ö –¥—Ä–æ–Ω–æ–≤, 
–º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—â–∏–π —Å–æ–≤–æ–∫—É–ø–Ω—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏ –∏ –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –ø—Ä–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –º–µ–Ω—è—é—â–∏—Ö—Å—è —Ç–∞—Ä–∏—Ñ–∞—Ö, –∏ –ø–æ–∫–∞–∑–∞—Ç—å, 
—á—Ç–æ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∑–∞–¥–∞—á–∞ –∫–æ–º–º–∏–≤–æ—è–∂—ë—Ä–∞ (TSP) —è–≤–ª—è–µ—Ç—Å—è –ª–∏—à—å –µ—ë —á–∞—Å—Ç–Ω—ã–º —Å–ª—É—á–∞–µ–º.
2024-07-27 16:42:12,988 - __main__ - INFO - ================================================================================

2024-07-27 16:42:12,988 - __main__ - INFO - 
üîÑ –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π...

2024-07-27 16:42:12,988 - __main__ - INFO - 
ü§î –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —à–∞–≥–∞ 1...
...
```

## –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤

–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–∞, –∑–∞–≥—Ä—É–∑–∫—É –≥—Ä–∞—Ñ–∞, –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–ø—Ä–æ—Å–∞, –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∏ –æ—Ü–µ–Ω–∫—É —à–∞–≥–æ–≤ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏–π, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Ü–µ–ø–æ—á–∫–∏ –∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞.  –ö–∞–∂–¥—ã–π —à–∞–≥ —Ä–∞—Å—Å—É–∂–¥–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ç–∏–ø–∞ –¥–µ–π—Å—Ç–≤–∏—è, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞, –µ—Å–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –≥—Ä–∞—Ñ–æ–º.  –í –∫–æ–Ω—Ü–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å.
