# Project Management System

## Оглавление
1. [Обзор системы](#обзор-системы)
2. [Архитектура](#архитектура)
3. [Микросервисы](#микросервисы)
4. [Развертывание](#развертывание)
5. [Тестирование](#тестирование)
6. [Безопасность](#безопасность)
7. [Мониторинг](#мониторинг)
8. [Разработка](#разработка)

## Обзор системы

Project Management System - это микросервисная система управления проектами, состоящая из трех основных сервисов и базы данных PostgreSQL. Система обеспечивает полный цикл управления проектами и задачами с поддержкой многопользовательского режима.

### Ключевые возможности
- Управление пользователями и аутентификацией
- Создание и управление проектами
- Управление задачами с приоритетами и статусами
- REST API для всех операций
- Docker-based развертывание
- Автоматизированное тестирование

## Архитектура

### Компоненты системы
1. **User Service** (Порт 8000)
   - Управление пользователями
   - JWT аутентификация
   - Авторизация

2. **Project Service** (Порт 8001)
   - Управление проектами
   - Права доступа
   - Интеграция с User Service

3. **Task Service** (Порт 8002)
   - Управление задачами
   - Статусы и приоритеты
   - Интеграция с Project Service

4. **PostgreSQL** (Порт 5432)
   - Хранение данных всех сервисов
   - Миграции через Alembic
   - Общая схема данных

### Структура проекта
```
project-management-system/
├── docker-compose.yml           # Docker конфигурация
├── init-scripts/                # Скрипты инициализации БД
├── services/
│   ├── user_service/
│   ├── project_service/
│   ├── task_service/
│   └── Dockerfile              # Multi-stage сборка
├── test_services.sh            # Скрипт тестирования
└── README.md                   # Документация
```

## Развертывание

### Предварительные требования
- Docker и Docker Compose
- PostgreSQL 13+
- Python 3.12+
- Bash (для тестирования)

### Установка и запуск

1. Клонирование репозитория:
```bash
git clone <repository-url>
cd project-management-system
```

2. Настройка переменных окружения:
```bash
# .env файл в корне проекта
DATABASE_URL=postgresql://admin:secret@postgres-db:5432/project_management
SECRET_KEY=your-secret-key
USER_SERVICE_URL=http://user-service:8000
PROJECT_SERVICE_URL=http://project-service:8001
TASK_SERVICE_URL=http://task-service:8002
```

3. Запуск через Docker Compose:
```bash
docker compose up --build
```

### Проверка работоспособности
```bash
# Проверка статуса сервисов
docker compose ps

# Проверка логов
docker compose logs -f
```

## Тестирование

### Автоматизированное тестирование
Система включает скрипт комплексного тестирования `test_services.sh`, который проверяет:

1. Конфигурацию окружения
2. Доступность сервисов
3. Подключение к PostgreSQL
4. Структуру базы данных
5. Создание и аутентификацию пользователей
6. Операции с проектами
7. Управление задачами
8. Каскадное удаление

```bash
# Запуск тестов
./test_services.sh

# Результаты
cat test_results.log
```

## Безопасность

### Аутентификация
- JWT токены для всех сервисов
- Хеширование паролей (bcrypt)
- OAuth2 с Bearer токенами

### Права доступа
- Разграничение на уровне пользователей
- Проверка владельца проекта
- Валидация всех запросов

### Сетевая безопасность
- CORS настройки
- HTTPS поддержка
- Rate limiting

### Мониторинг проблем
1. Проверка статуса сервисов
```bash
curl http://localhost:8000/health
curl http://localhost:8001/health
curl http://localhost:8002/health
```

2. Проверка логов
```bash
# Последние ошибки
docker compose logs --tail=100 service-name | grep ERROR

# Логи конкретного контейнера
docker logs container-id
```

3. Метрики системы
```bash
# Использование ресурсов
docker stats

# Статистика БД
psql -c "SELECT * FROM pg_stat_activity;"
```

## Разработка

### Требования к окружению
- Python 3.12+
- Poetry или pip
- PostgreSQL 13+
- Docker и Docker Compose

### Рекомендации по разработке
- Следуйте PEP 8
- Используйте типизацию
- Документируйте API
- Пишите тесты

### Процесс разработки
1. Создайте ветку для фичи
2. Разработайте функционал
3. Добавьте тесты
4. Создайте PR
5. После проверки сделайте merge
