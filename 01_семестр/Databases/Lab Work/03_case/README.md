# üöÄ SQL-–∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂ –∏ –ø—Ä–µ–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

## üìä –û –ø—Ä–æ–µ–∫—Ç–µ

–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–±–æ—Ä SQL-–∑–∞–ø—Ä–æ—Å–æ–≤, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–¥–∞–∂ –∏ –ø—Ä–µ–º–∏—Ä–æ–≤–∞–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –≤ –∫–æ–º–ø–∞–Ω–∏–∏. –ó–∞–ø—Ä–æ—Å—ã –æ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä –æ–ø–µ—Ä–∞—Ü–∏–π SQL, –≤–∫–ª—é—á–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ–º–∏–π, –∞–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ –ø—Ä–æ–¥–∞–∂ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –æ—Ñ–∏—Å–æ–≤.

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–¥–∞–∂–∏ –∏ –ø—Ä–µ–º–∏—Ä–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- üß† –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ñ–∏—Å–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –ø—Ä–æ–¥–∞–∂
- üìà –û—Ü–µ–Ω–∏–≤–∞—Ç—å –¥–∏–Ω–∞–º–∏–∫—É —Ä–æ—Å—Ç–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ —Ç–æ–≤–∞—Ä–∞–º
- üíº –ü–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫—É–ø–∫–∏ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–±—ã–ª—å –∫–æ–º–ø–∞–Ω–∏–∏

## üìö –ò–∑—É—á–∞–µ–º—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ SQL

- –ê–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (SUM, MIN, MAX)
- –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (ROW_NUMBER, NTILE, LAG)
- –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü (JOIN)
- –ü–æ–¥–∑–∞–ø—Ä–æ—Å—ã –∏ CTE (Common Table Expressions)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (GROUP BY)
- –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏ (DATE_TRUNC, EXTRACT)
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (WHERE)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤

1. **–ü—Ä–µ–º–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤**
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–µ–º–∏–∏ –≤ —Ä–∞–∑–º–µ—Ä–µ 5% –æ—Ç —Å—É–º–º—ã –ø—Ä–æ–¥–∞–∂ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ 3 –º–µ—Å—è—Ü–∞
   - –í—ã–≤–æ–¥ –º–µ—Å—è—Ü–∞, `manager_id`, `manager_first_name`, `manager_last_name`, –ø—Ä–µ–º–∏–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ —Å —è–Ω–≤–∞—Ä—è –ø–æ –¥–µ–∫–∞–±—Ä—å 2014 –≥–æ–¥–∞

2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –æ—Ñ–∏—Å–æ–≤**
   - –ê–Ω–∞–ª–∏–∑ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –ø—Ä–æ–¥–∞–∂ –ø–æ –æ—Ñ–∏—Å–∞–º –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ —Å 2013 –ø–æ 2014 –≥–æ–¥
   - –í—ã–≤–æ–¥ –≥–æ–¥–∞, `office_id`, `city_name`, `country`, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –æ–±—ä–µ–º –ø—Ä–æ–¥–∞–∂ –∑–∞ —Ç–µ–∫—É—â–∏–π –≥–æ–¥

3. **–î–∏–Ω–∞–º–∏–∫–∞ —Ä–æ—Å—Ç–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ —Ç–æ–≤–∞—Ä–∞–º**
   - –û—Ü–µ–Ω–∫–∞ –¥–∏–Ω–∞–º–∏–∫–∏ —Ä–æ—Å—Ç–∞ –ø—Ä–æ–¥–∞–∂ –∫–∞–∫ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –æ–±—ä–µ–º–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É
   - –í—ã–≤–æ–¥ —Ç–æ–≤–∞—Ä–æ–≤ —Å –Ω–∞–∏–±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–º–∏ —Ç–µ–º–ø–∞–º–∏ —Ä–æ—Å—Ç–∞ –ø—Ä–æ–¥–∞–∂ –≤ —Ç–µ—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—É–≥–æ–¥–∏—è 2014 –≥–æ–¥–∞

4. **–û—Ç—á–µ—Ç –æ –ø—Ä–∏–±—ã–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏**
   - –í—ã–≤–æ–¥ –æ—Ç—á–µ—Ç–∞ –æ –ø—Ä–∏–±—ã–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –∑–∞ 2014 –≥–æ–¥: –ø–æ–º–µ—Å—è—á–Ω–æ –∏ –ø–æ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ
   - –í–∫–ª—é—á–µ–Ω–∏–µ —Å—É–º–º—ã –ø—Ä–∏–±—ã–ª–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥ –∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–π —Å—É–º–º—ã –ø—Ä–∏–±—ã–ª–∏ —Å –Ω–∞—á–∞–ª–∞ –≥–æ–¥–∞

5. **–í–∫–ª–∞–¥ –≤ –æ–±—â—É—é –ø—Ä–∏–±—ã–ª—å**
   - –ê–Ω–∞–ª–∏–∑ –≤–∫–ª–∞–¥–∞ –≤ –æ–±—â—É—é –ø—Ä–∏–±—ã–ª—å 10% –Ω–∞–∏–±–æ–ª–µ–µ –¥–æ—Ä–æ–≥–∏—Ö –∏ 10% –Ω–∞–∏–±–æ–ª–µ–µ –¥–µ—à–µ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
   - –í—ã–≤–æ–¥ `product_id`, `product_name`, `total_sale_amount`, `percent`

6. **–ü—Ä–µ–º–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –ø–æ —Å—Ç—Ä–∞–Ω–∞–º**
   - –ü—Ä–µ–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ—Ö –Ω–∞–∏–±–æ–ª–µ–µ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ã—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –≤ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–µ –≤ 2014 –≥–æ–¥—É
   - –í—ã–≤–æ–¥ `country`, —Å–ø–∏—Å–æ–∫ `manager_last_name` –∏ `manager_first_name`, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–π –∑–∞–ø—è—Ç—ã–º–∏

7. **–°–∞–º—ã–π –¥–µ—à–µ–≤—ã–π –∏ —Å–∞–º—ã–π –¥–æ—Ä–æ–≥–æ–π —Ç–æ–≤–∞—Ä**
   - –í—ã–≤–æ–¥ —Å–∞–º–æ–≥–æ –¥–µ—à–µ–≤–æ–≥–æ –∏ —Å–∞–º–æ–≥–æ –¥–æ—Ä–æ–≥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞, –ø—Ä–æ–¥–∞–Ω–Ω–æ–≥–æ –∑–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü –≤ —Ç–µ—á–µ–Ω–∏–µ 2014 –≥–æ–¥–∞
   - –í—ã–≤–æ–¥ `cheapest_product_id`, `cheapest_product_name`, `expensive_product_id`, `expensive_product_name`, `month`, `cheapest_price`, `expensive_price`

8. **–ü—Ä–∏–±—ã–ª—å –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è**
   - –†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –∑–∞ 2014 –≥–æ–¥ –ø–æ –º–µ—Å—è—Ü–∞–º —Å —É—á–µ—Ç–æ–º –∑–∞—Ä–ø–ª–∞—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –∏—Å—Ö–æ–¥–Ω–æ–π —Å—Ç–æ–∏–º–æ—Å—Ç–∏ —Ç–æ–≤–∞—Ä–æ–≤
   - –í—ã–≤–æ–¥ `month`, `sales_amount`, `salary_amount`, `profit_amount`

## üóÑÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–∞–±–ª–∏—Ü—ã

- `MANAGER`: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞—Ö
  - `MANAGER_ID` (PK), `MANAGER_FIRST_NAME`, `MANAGER_LAST_NAME`, `OFFICE_ID` (FK)

- `OFFICE`: –î–∞–Ω–Ω—ã–µ –æ–± –æ—Ñ–∏—Å–∞—Ö
  - `OFFICE_ID` (PK), `CITY_ID` (FK), `OFFICE_NAME`

- `PRODUCT`: –ö–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
  - `PRODUCT_ID` (PK), `PRODUCT_NAME`

- `SALES_ORDER`: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–∞—Ö
  - `SALES_ORDER_ID` (PK), `ORDER_DATE`, `MANAGER_ID` (FK)

- `SALES_ORDER_LINE`: –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–∞—Ö –≤ –∑–∞–∫–∞–∑–∞—Ö
  - `ORDER_LINE_ID` (PK), `SALES_ORDER_ID` (FK), `PRODUCT_ID` (FK), `PRODUCT_QTY`, `PRODUCT_PRICE`

- `CITY`: –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
  - `CITY_ID` (PK), `CITY_NAME`, `REGION`, `COUNTRY`

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQL –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–Ω—è—Ç–∏—è –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏–π. –ó–∞–ø—Ä–æ—Å—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω—ã —Å —É—á–µ—Ç–æ–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∫–æ–¥–∞.